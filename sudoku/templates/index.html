{% extends "base.html" %}

{% block content %}
    <div>
        <p>
            Pas besoin de te prendre la tête avec la grille de Sudoku. Prends juste ton téléphone, clique sur une photo
            de la grille et laisse <strong> Sudoku App </strong> faire le boulot.
        </p>
        <p>
            Allez, prends une photo de ta grille de Sudoku et tu vas voir, notre appli se charge de tout, en pondant une
            solution en un clin d'œil.
        </p>
        <p>
            Vas-y, transforme ton expérience du Sudoku avec notre appli ! Tu vas voir, c'est du lourd !
        </p>
    </div>
    <section>
        <h1>1. Choisis une photo</h1>
        <p>Sélectionne sur ton appareil une image de grille de sudoku à analyser.</p>
        <form method="post" action="{% url 'app:upload_photo' %}"
              enctype="multipart/form-data">
            {% csrf_token %}
            <div>
                {{ form.photo.label_tag }} {{ form.photo }}
                <button type="submit">Charger une nouvelle image</button>
            </div>
        </form>
        {% if form.errors %}
            <div class="alert alert-danger">
                <ul>
                    {% for field in form %}
                        <!-- This is how to iterate on each field of the form -->
                        {% for error in field.errors %}
                            <!-- This will display each error of every field -->
                            <li><strong>{{ field.label }}:</strong> {{ error }}</li>
                        {% endfor %}
                    {% endfor %}
                </ul>
            </div>
        {% endif %}

        {% if latest_images %}
            <form method="get" action="{% url 'app:upload_latest' %}">
                <p>OU</p>
                <label for="latestImage">Choisir l´une des photos dejà chargées:</label>
                <select id="latestImage" name="latestImageId">
                    {% for latest_image in latest_images %}
                        {% if latest_image.id == image.id %}
                            <option value="{{ latest_image.id }}" selected>Image #{{ latest_image.id }} - uploaded
                                at {{ latest_image.uploaded_at }}</option>
                        {% else %}
                            <option value="{{ latest_image.id }}">Image #{{ latest_image.id }} - uploaded
                                at {{ latest_image.uploaded_at }}</option>
                        {% endif %}
                    {% endfor %}
                </select>
                <button type="submit">Charger image</button>
            </form>
        {% endif %}
    </section>
    <section>
        <h1>2. Initialise la grille</h1>
        {% include 'process.html' %}
        <button hx-get="{% url 'app:prepare-board' %}"
                hx-target='#board-container'
                hx-trigger="click"
                hx-swap="innerHTML">Initialiser la grille
        </button>
        <div id="board-container"></div>
    </section>
    <section>
        <h1>3. Obtiens la solution</h1>
    </section>
    <section>
        {% include 'board/partials/board-cell.html' %}
    </section>

{% endblock content %}